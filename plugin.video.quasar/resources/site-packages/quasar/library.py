import xbmc
import time
import urllib2
from quasar.addon import ADDON
from quasar.config import QUASARD_HOST

def library_thread():
    limit = 8 * 60 * 60
    count = limit - int(ADDON.getSetting("library_update_delay"))
    while not xbmc.abortRequested:
        # 8 hours passed - Update Library
        if count >= limit:
            count = 0
            try:
                urllib2.urlopen(QUASARD_HOST + "/library/update")
            except:
                pass
        time.sleep(3)
        count += 3
